<?xml version="1.0" encoding="Windows-1252"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" MadCap:tocPath="AeroBasic Programming|Example Programs|Advanced Programming" MadCap:InPreviewMode="false" MadCap:PreloadImages="false" MadCap:RuntimeFileType="Topic" MadCap:TargetType="HtmlHelp" MadCap:conditions="" MadCap:PathToHelpSystem="../" MadCap:HelpSystemFileName="A3200.xml" MadCap:SearchType="Stem">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252" /><title>Fast Task Execution Example</title>
        <link href="../SkinSupport/Slideshow.css" rel="stylesheet" />
        <link href="../SkinSupport/MadCap.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/Header.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/MasterPage_Footer.css" rel="stylesheet" />
        <link href="../Resources/Stylesheets/AerotechHelpStyles.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/Header.css" rel="stylesheet" />
        <link href="../Resources/TableStyles/CodeEx.css" rel="stylesheet" />
        <script src="../SkinSupport/jquery.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapGlobal.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapSlideshow.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapMerging.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapAliasFile.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapUtilities.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapBody.js" type="text/javascript">
        </script>
        <script src="../SkinSupport/MadCapHighlighter.js" type="text/javascript">
        </script>
    </head>
    <body>
        <script type="text/javascript">
            <!--
			window.onbeforeprint = function(e) {
				var nodes = document.getElementsByTagName("*");
				for (var i = 0; i < nodes.length; i++ ) {			
					if (nodes[i].nodeType == 1)
					{
						var args = nodes[i].attributes;
						for (var j = 0; j < args.length; j++) {
						if ( args[j].name == "MadCap:targetName" )
						{
							nodes[i].setAttribute( "className", "MCTogglerBody" );
						}
						}
					}
				}
			}						
			-->
        </script>
        <table style="width: 100%;margin-left: -7px;margin-right: auto;mc-table-style: url('../Resources/TableStyles/Header.css');" cellspacing="0" MadCap:conditions="AerotechConditions.A3200Only" class="TableStyle-Header">
            <col class="TableStyle-Header-Column-Column1" />
            <tbody>
                <tr class="TableStyle-Header-Body-Body1" style="height: 55px;">
                    <td style="background-repeat: no-repeat;vertical-align: top;background-image: url('../Resources/Images/Header/Header_A3200.png');background-position-y: top;padding-left: 0px;padding-right: 0px;padding-top: 0px;padding-bottom: 0px;border-left-style: none;border-right-style: none;border-top-style: none;border-bottom-style: none;border-bottom-width: 1px;border-bottom-color: #dae3ea;" class="TableStyle-Header-BodyA-Column1-Body1">
                        <div class="MCBreadcrumbsBox_MD_0"><span class="MCBreadcrumbsPrefix">You are here: </span><a class="MCBreadcrumbsLink" href="../Programming_Overview.htm">AeroBasic Programming</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="Example_Programs.htm">Example Programs</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="skill__4.html">Advanced Programming</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Fast Task Execution</span>
                        </div>
                    </td>
                </tr>
            </tbody>
        </table><a name="kanchor2643"></a>
        <h1 MadCap:autonum=""><span class="autonumber"><span></span></span>Fast Task Execution Example</h1>
        <p>Before you run an <span class="AerotechVariablesSimpleName_AeroBasic">AeroBasic</span> example program, copy the example to your User Files directory. Copying the example makes sure that you have access to compile and run the program and prevents changes that you make from being overwritten if you install updated software.</p>
        <p>View the example program in <span class="AerotechVariablesSimpleName_A3200">A3200</span> <span class="AerotechVariablesSimpleName_MotionComposer">Motion Composer</span>. <span class="AerotechVariablesSimpleName_MotionComposer">Motion Composer</span> adds color in the code which makes it easier to read. For best results, do one of the following.</p>
        <ul>
            <li class="BulletLevel1" value="1">Open a new file in <span class="procedureTerm"><span class="AerotechVariablesSimpleName_MotionComposer">Motion Composer</span></span>. Copy and paste the code into the file.</li>
            <li class="noBulletLevel1">OR</li>
            <li class="BulletLevel1" value="2">To examine the source code, open the example program from your User Files directory. You might have to copy the example program from the \<span class="AerotechVariablesSimpleName_A3200">A3200</span>\Samples\<span class="AerotechVariablesSimpleName_AeroBasic">AeroBasic</span> folder first.</li>
        </ul>
        <p>This example is one of many example programs. For a complete list of examples, refer to <a href="Example_Programs.htm">Example Programs</a>.</p>
        <p>
            <MadCap:conditionalText MadCap:conditions="OutputTypeConditions.ScreenOnly">To see a list of available hardware manuals, refer to <a href="../Other_Documentation.htm" MadCap:conditions="AerotechConditions.Option_MainA3200">Other Documentation</a>.</MadCap:conditionalText>
        </p>
        <table class="TableStyle-CodeEx" style="mc-table-style: url('../Resources/TableStyles/CodeEx.css');margin-left: 0;margin-right: auto;caption-side: top;" cellspacing="0">
            <col style="width: 647px;" class="TableStyle-CodeEx-Column-Column1" />
            <tbody>
                <tr class="TableStyle-CodeEx-Body-Body1">
                    <td class="TableStyle-CodeEx-BodyA-Column1-Body1"><pre>'				FastTask.pgm
'
'
' Fast-task program
' This entire program will execute every millisecond.
'
' This program monitors the position feedback and
' sets the output to the defined state at each position.
' The output values are interpolated, based upon
' the axis position
'
' This program utilizes two equal-sized arrays: one
' for the array of positions and the other for the
' array of output values.
'
' The position feedback is monitored to determine if
' it exceeds the threshold defined in the first array.		

DVAR $XNotDone, $Index    
DVAR $NumPointsX
DVAR $PointLowX[ 10 ] 
DVAR $PointHighX[ 10 ]
DVAR $StateX[ 10 ]

$NumPointsX = 10

' Assign the low positions
$PointLowX[0] = 10		
$PointLowX[1] = 20
$PointLowX[2] = 30 
$PointLowX[3] = 40  
$PointLowX[4] = 50  
$PointLowX[5] = 60 
$PointLowX[6] = 70  
$PointLowX[7] = 80 
$PointLowX[8] = 90 
$PointLowX[9] = 100 
' Assign the high positions
$PointHighX[0] = 19		
$PointHighX[1] = 29
$PointHighX[2] = 39
$PointHighX[3] = 49
$PointHighX[4] = 59
$PointHighX[5] = 69
$PointHighX[6] = 79
$PointHighX[7] = 89
$PointHighX[8] = 99
$PointHighX[9] = 109
' Assign the output states
$StateX[0] = 1						
$StateX[1] = 0
$StateX[2] = 1
$StateX[3] = 0
$StateX[4] = 1
$StateX[5] = 0
$StateX[6] = 1
$StateX[7] = 0
$StateX[8] = 1
$StateX[9] = 0	

' Clear output(s) if desired
' $do0.X = 0			

' Having the CRITICAL START and CRITICAL END around the While 
' loop ensures that the code used to evaluate the while condition
' is executed as part of the critical section.  Without 
' structuring it this way, the code in the Critical section will
' not run every millisecond.

' All code following this line until CRITICAL END
' will execute within 1 millisecond. If there is too 
' much code to run in 1 millisecond, a real-time error
' could occur.  To avoid a real-time error, a DWELL
' is placed in the loop to cause the task to give up
' its time slice.
CRITICAL START

' Infinite while loop, program will never stop
WHILE 1		
	' Begin X axis aux table
	' Set X table not done flag
	$XNotDone = 1		
	' Aux table point index
	$Index = 0							        
	WHILE( $XNotDone == 1 )
		' Have all points been scanned?
		IF( $Index &lt; $NumPointsX )				
			IF( (AXISSTATUS(X, DATAITEM_PositionCommand) &gt;= $PointLowX[$Index]) AND (AXISSTATUS(X, DATAITEM_PositionCommand) &lt;= $PointHighX[$Index] ) )
				' Set output state.
				$DO[0].X = $StateX[$Index]
				' X range found, so exit table scan.
				$XNotDone = 0				
			ENDIF
			' Increment to next point in table. 
			$Index = $Index + 1				
		ELSE
			' Table scan complete (outside table range).
		  	$XNotDone = 0					
		ENDIF
	WEND

	' This allows other tasks and activities in the controller
	' to run for the remainder of the millisecond. Without this,
	' the task would run indefinitely, causing a real-time error.
	DWELL 0.001
	
WEND

' End the critical section
CRITICAL END

END PROGRAM</pre>
                    </td>
                </tr>
            </tbody>
        </table>
        <MadCap:pageFooter class="OddPage">
            <hr color="#006400" width="100%" size="0" align="center" />
            <table style="width: 100%;border-left-style: none;border-left-width: 1px;border-right-style: none;border-right-width: 1px;border-top-style: none;border-top-width: 1px;border-bottom-style: none;border-bottom-width: 1px;margin-left: 0;margin-right: auto;mc-table-style: url('../Resources/TableStyles/MasterPage_Footer.css');" class="TableStyle-MasterPage_Footer" cellspacing="0">
                <col class="Column-Column1" />
                <col class="Column-Column2" />
                <tbody>
                    <tr class="Body-Body1">
                        <td class="BodyB-Column1-Body1">
                            <p class="feedback">Was this information helpful?</p><a href="http://help.aerotech.com/feedback/?product=A3200&amp;type=help&amp;id=Fast_Task_Execution.htm&amp;version=6.04.003&amp;helpful=yes" target="_blank"><div class="feedback"><p>Yes</p></div></a><a href="http://help.aerotech.com/feedback/?product=A3200&amp;type=help&amp;id=Fast_Task_Execution.htm&amp;version=6.04.003&amp;helpful=no" target="_blank"><div class="feedback"><p>No</p></div></a>
                        </td>
                        <td class="BodyA-Column2-Body1" style="text-align: right;">
                            <p class="footer"><span class="AerotechVariablesCompanyName">Aerotech, Inc.</span>
                            </p>
                            <p class="trademarkandCopyright" style="text-align: right;" MadCap:conditions="AerotechConditions.A3200Only,AerotechConditions.A3200Programming,AerotechConditions.Option_LabVIEWA3200">Copyright <img src="../Resources/Images/Header/CopyrightSymbol.png" /> 2001-<span class="AerotechVariablesCurrentYear">2020</span></p>
                            <p class="footer"> All Rights Reserved </p>
                            <p class="footer"><a href="mailto:Support@aerotech.com" target="_blank" title="Support Email Address" alt="Support Email Address">Support@aerotech.com</a>
                            </p>
                            <p class="footer"><a href="http://www.aerotech.com/" target="_blank" title="http://www.aerotech.com" alt="http://www.aerotech.com"><span class="AerotechVariablesWebAddress">www.aerotech.com</span></a>
                            </p>
                        </td>
                    </tr>
                </tbody>
            </table>
        </MadCap:pageFooter>
        <script type="text/javascript" src="../SkinSupport/MadCapBodyEnd.js">
        </script>
    </body>
</html>